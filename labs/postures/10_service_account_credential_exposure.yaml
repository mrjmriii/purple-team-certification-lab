id: "10"
name: "Service account credential exposure"
category: "Social Engineering Drift"
pretext: "Share creds quickly for deployment"
human_factor: "Speed over safety"
drift_change:
  description: "Secrets stored in plaintext"
  scope: ["path:/tmp/service-creds.txt"]
assumed_access:
  credentials: "Plaintext secret available"
  network: "Localhost HTTP"
mapped_kill_chain:
  - phase: "Credential Access"
    technique: "Unsecured Credentials (T1552)"
    scripts: ["secret_file_scan.py"]
    telemetry: ["stdout: found token marker"]
  - phase: "Persistence"
    technique: "Create Account / Token Persistence"
    scripts: ["token_store_temp.py"]
    telemetry: ["file: /tmp/token_store.json"]
  - phase: "Execution"
    technique: "Command Execution (T1059)"
    scripts: ["token_use_log.py"]
    telemetry: ["curl http://localhost:8080/api?token=..."]
expected_wazuh_alerts:
  - { name: "Secret file read", rule_id: "TODO-SECRET-READ", evidence: ["/tmp/service-creds.txt access"] }
  - { name: "Token use HTTP", rule_id: "TODO-TOKEN-USE", evidence: ["curl with token param"] }
detection_notes:
  false_positive_considerations: ["Test tokens"]
  tuning: ["Scope to temp paths; token marker strings"]
runner_parameters:
  timeout_seconds: 180
  artifacts_path: "/tmp/purple-lab-artifacts"
  log_level: "info"
