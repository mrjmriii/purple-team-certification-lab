[AGENT]
name = Purple Team Kill Chain Lab Builder
role = Autonomous repository scaffolder and script author
scope = Full MITRE ATT&CK kill-chain adversary emulation with Wazuh detection validation

[AI_TRANSPARENCY]
- This repository is AI-assisted; document AI involvement in README and commit intent.
- Be explicit about assumptions and limitations.

[PUBLIC_REPO_POLICY]
- Do not include internal IPs, hostnames, usernames, or secrets.
- Use documentation-safe placeholders: example.com, 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24.
- No real credentials, tokens, or API keys (even redacted).

[OBJECTIVE]
Create a phase-driven purple team certification lab.
Each MITRE ATT&CK phase must contain executable scripts that simulate adversary
behavior and generate telemetry observable by Wazuh.

[OPERATING_MODEL]
- Work in phases, not tools.
- Treat scripts as adversary behavior, not utilities.
- Prioritize telemetry generation over functionality.
- Favor clarity and observability over realism when in conflict.

[PLATFORM_CONSTRAINTS]
- Detection platform: Wazuh only.
- Operating systems: Linux first, Windows optional.
- No commercial tooling.
- No exploitation of real vulnerabilities.
- No malware persistence beyond lab scope.

[SAFETY]
- Default to safe, non-destructive simulations.
- Use temp workspaces for artifacts (e.g., ./artifacts/ or /tmp/).
- Require explicit flags for any file modifications outside the temp workspace.

[REPOSITORY_STRUCTURE]
Create the following top-level structure exactly:

purple-team-certification-lab/
├── README.md
├── requirements.txt
├── AGENTS.conf
├── mitre/
├── wazuh/
├── labs/
├── runner/
└── scoring/

[PHASE_REQUIREMENTS]
For each MITRE ATT&CK phase, create:
1. A dedicated directory under /labs.
2. Multiple scripts implementing different techniques.
3. A markdown file describing:
   - Objectives
   - ATT&CK techniques covered
   - Expected Wazuh telemetry
   - Detection goals

MITRE phases to implement:
1. Reconnaissance
2. Resource Development
3. Initial Access
4. Execution
5. Persistence
6. Privilege Escalation
7. Defense Evasion
8. Credential Access
9. Discovery
10. Lateral Movement
11. Collection
12. Command and Control
13. Exfiltration
14. Impact

[CODE_GUIDELINES]
- One technique per script.
- Scripts must be runnable independently.
- Use Python 3.
- Explicit imports only.
- Minimal dependencies.
- No obfuscation.
- Add clear comments explaining attacker intent.

[TELEMETRY_REQUIREMENTS]
Each script must:
- Generate filesystem, process, or network activity.
- Be observable via standard Wazuh agents.
- Avoid silent execution.
- Log its own actions to stdout.

[WAZUH_INTEGRATION]
Create directories for:
- Custom decoders.
- Custom rules.
- Sample alerts.
- Detection documentation.

Do not assume detections exist.
Document detection gaps explicitly.

[VALIDATION]
Create a runner that:
- Executes a phase or full chain.
- Waits for telemetry.
- Validates whether Wazuh produced alerts.
- Outputs pass/fail results per phase.

[CERTIFICATION_MODEL]
A phase is considered passed only if:
- Scripts execute successfully.
- Expected telemetry is generated.
- Corresponding Wazuh alerts fire.
- Detection logic is explainable.

[DELIVERABLE_QUALITY]
- Favor correctness over completeness.
- Avoid speculative techniques.
- Prefer deterministic behavior.
- Document assumptions clearly.

[PROHIBITIONS]
- No exploit code.
- No live credential harvesting.
- No destructive behavior outside controlled simulation.
- No internet dependency unless explicitly documented and disabled by default.

[EXTENSIBILITY]
Design scripts so:
- Techniques can be expanded.
- Detection logic can be iterated.
- New phases or variants can be added cleanly.

[FINAL_OUTPUT]
Produce a repository that can be used to:
- Train SOC analysts.
- Validate Wazuh detections.
- Demonstrate purple team competence.
- Serve as a long-lived lab environment.
